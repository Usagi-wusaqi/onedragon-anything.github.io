---
lang: zh-CN
title: 基础-04-操作指令
---

`operations` 是一个指令数组，脚本会按顺序执行其中的每一条指令。

```yaml
operations:
  - op_name: "按键-普通攻击"
    post_delay: 0.2
  - op_name: "按键-特殊攻击"
```

## 1. 指令名称 (op_name)

每条指令通过 `op_name` 告诉脚本要执行什么操作。

**可用 op_name 列表：**

```
战斗相关: 按键-闪避, 按键-普通攻击, 按键-特殊攻击, 按键-终结技, 按键-快速支援
角色切换: 按键-切换角色-下一个, 按键-切换角色-上一个, 按键-切换角色 (需 agent_name)
连携技:   按键-连携技-左, 按键-连携技-右, 按键-连携技-取消
移动:     按键-移动-前, 按键-移动-后, 按键-移动-左, 按键-移动-右
其他:     按键-锁定敌人
```

## 2. 操作变体

每个按键指令都支持三种模式，通过添加后缀或使用 `way` 参数控制：

### 2.1. 点击（默认）

执行一次快速的按下和松开。

```yaml
- op_name: "按键-普通攻击"
```

### 2.2. 按下

只执行"按下"动作，用于长按。可通过后缀 `-按下` 或 `way: "按下"` 指定。

```yaml
- op_name: "按键-特殊攻击-按下"
# 等价于
- op_name: "按键-特殊攻击"
  way: "按下"
```

### 2.3. 松开

只执行"松开"动作，用于结束长按或防止按键卡住。

```yaml
- op_name: "按键-特殊攻击-松开"
```

## 3. 通用参数

| 参数 | 类型 | 默认 | 说明 |
|---|---|---|---|
| `pre_delay` | 数字 | 0 | 按键**前**等待的秒数 |
| `post_delay` | 数字 | 0 | 按键**后**等待的秒数。**禁止接在长按（按下）后面** |
| `way` | 字符串 | 点按 | 按键方式：`点按` / `按下` / `松开` |
| `press` | 数字 | — | 按下持续秒数，不填代表不自动松开 |
| `repeat` | 数字 | 1 | 重复执行次数 |

> **重要规则**：绝区零游戏引擎只接受 0.1 秒以上的按键间隔。连续操作之间必须用 `post_delay` 或 `等待秒数` 确保至少 0.1 秒的间隔。

## 4. 特殊指令

### 4.1. 等待秒数

在两个操作之间插入明确的停顿。

```yaml
- op_name: "等待秒数"
  seconds: 0.5
```

### 4.2. 设置状态

设置一个自定义状态，用于不同处理器之间的通信。

```yaml
- op_name: "设置状态"
  state: "自定义-失衡计时"        # 要设置的状态名
  seconds: 5.0                   # 状态持续时间（秒），负数代表倒计时
  value: 100                     # 设置状态的具体值（整数）
  add: 50                        # 在现有状态值上增加（整数），value 存在时不生效
```

| 参数 | 说明 |
|---|---|
| `state` | 需要设置的状态名称 |
| `state_list` | 需要设置的状态名称列表，传入时 `state` 不生效 |
| `seconds` | 状态触发距离当前时间的偏移秒数，默认 0（当前） |
| `seconds_add` | 在现有偏移秒数基础上增加，用于延长倒计时 |
| `value` | 设置状态的具体值（整数） |
| `add` | 对当前状态值进行增加（整数），`value` 存在时不生效 |

### 4.3. 清除状态

清除一个或多个自定义状态。

```yaml
- op_name: "清除状态"
  state_list: ["自定义-状态A", "自定义-状态B"]
```

### 4.4. 按键-切换角色

按名称切换到指定角色，仅在 **平时切换** 或 **招架支援 / 极限支援** 时使用。连携技、快速支援时不要用。

```yaml
- op_name: "按键-切换角色"
  agent_name: "安比"
```

> 注意：按键后触发的状态是 `按键-切换角色-下一个` 或 `按键-切换角色-上一个`。

## 5. 完整指令速查表

|指令名称|参数|备注|
|---|---|---|
|按键-闪避|pre_delay, post_delay, way, press, repeat||
|按键-切换角色-下一个|同上||
|按键-切换角色-上一个|同上||
|按键-切换角色|agent_name, pre_delay, post_delay|仅平时切换或招架/极限支援时使用|
|按键-普通攻击|pre_delay, post_delay, way, press, repeat||
|按键-特殊攻击|同上||
|按键-终结技|同上||
|按键-连携技-左|同上||
|按键-连携技-右|同上||
|按键-连携技-取消|同上|需按下一段时间才有效|
|按键-快速支援|pre_delay, post_delay|快速支援请用此指令切换角色|
|按键-移动-前/后/左/右|pre_delay, post_delay, way, press, repeat||
|按键-锁定敌人|同上||
|等待秒数|seconds||
|设置状态|state, state_list, seconds, seconds_add, value, add||
|清除状态|state, state_list||

## 6. 连招编写示例

### 示例 1：普攻 ×2 → 停顿 → 特殊攻击

```yaml
operations:
  - op_name: "按键-普通攻击"
    repeat: 2
    post_delay: 0.1
  - op_name: "等待秒数"
    seconds: 0.5
  - op_name: "按键-特殊攻击"
```

### 示例 2：长按特殊攻击 1.2 秒

```yaml
operations:
  - op_name: "按键-特殊攻击-按下"
  - op_name: "等待秒数"
    seconds: 1.2
  - op_name: "按键-特殊攻击-松开"
```

> 不推荐超过 2 秒的长按。如果需要更长时间，拆分为多个短 `按下` 指令。

### 示例 3：往前闪 A

```yaml
operations:
  - op_name: "按键-移动-前"
    way: "按下"
  - op_name: "等待秒数"
    seconds: 0.2
  - op_name: "按键-闪避"
    post_delay: 0.1
  - op_name: "按键-普通攻击"
  - op_name: "按键-移动-前"
    way: "松开"
```
